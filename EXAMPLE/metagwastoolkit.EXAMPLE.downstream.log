
                 PERFORM META-ANALYSIS OF GENOME-WIDE ASSOCIATION STUDIES
++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

FIFTH step: prepare and perform downstream analyses.
[1m+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++[00m
[1m          MetaGWASToolKit: A TOOLKIT FOR THE META-ANALYSIS OF GENOME-WIDE ASSOCIATION STUDIES[00m
[1m                            --- PERFORM AND PREPARE DOWNSTREAM ANALYSES ---[00m
[1m[00m
[1m* Version:      v1.7.1[00m
[1m[00m
[1m* Last update:  2018-08-09[00m
[1m* Based on:     MANTEL, as written by Sara Pulit, Jessica van Setten, and Paul de Bakker.[00m
[1m* Written by:   Sander W. van der Laan | s.w.vanderlaan@gmail.com.[00m
[1m                Sara Pulit; [00m
[1m                Jessica van Setten; [00m
[1m                Paul I.W. de Bakker.[00m
[1m* Testers:      Jessica van Setten.[00m
[1m* Description:  Perform a meta-analysis of genome-wide association studies. It will do the following:[00m
[1m                - Automatically parse the various cohort files.[00m
[1m                - Harmonize GWAS datasets relative to a reference.[00m
[1m                - Perform QC on GWAS datasets using user-defined settings.[00m
[1m                - Produce plots (PDF and PNG) for quick inspection and publication.[00m
[1m                - Run a meta-analysis using Random, Fixed, and Z-score methods.[00m
[1m                - Correct results for the genomic inflation factor.[00m
[1m                - Clump results based on a p-value threshold for downstream (meta-)analyses.[00m
[1m                - Produce plots (PDF and PNG) of the final meta-analysis results for publication.[00m
[1m                - Produce LocusZoom style regional plots for genome-wide significant hits.[00m
[1m                - Produce a ReadMe file.[00m
[1m[00m
[1m* REQUIRED: [00m
[1m  - A high-performance computer cluster with a qsub system[00m
[1m  - R v3.2+, Python 2.7+, Perl.[00m
[1m  - Required Python 2.7+ modules: [pandas], [scipy], [numpy].[00m
[1m  - Required Perl modules: [YAML], [Statistics::Distributions], [Getopt::Long].[00m
[1m  - Note: it will also work on a Mac OS X system with R and Python installed.[00m
[1m[00m
[1m+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++[00m
These are the 2 arguments that passed:
The configuration file.................: metagwastoolkit.conf
The list of GWAS files.................: metagwastoolkit.files.list

Checking for the existence of the output directory [ SOMEGWAS ].
> Output directory already exists.

Checking for the existence of the subproject directory [ SOMEGWAS/MODEL1 ].
> Subproject directory already exists.

Checking for the existence of the raw data directory [ SOMEGWAS/MODEL1/RAW ].
> Raw data directory already exists.

Checking for the existence of the meta-analysis results directory [ SOMEGWAS/MODEL1/META ].
> Meta-analysis results directory already exists.
Checking for the existence of the meta-analysis temporary results directory [ SOMEGWAS/MODEL1/META/TEMP ].
> Meta-analysis results temporary directory already exists.


+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

The scene is properly set, and directories are created! ðŸ––
MetaGWASToolKit program........................: /hpc/local/CentOS7/dhl_ec/software/MetaGWASToolKit
MetaGWASToolKit scripts........................: /hpc/local/CentOS7/dhl_ec/software/MetaGWASToolKit/SCRIPTS
MetaGWASToolKit resources......................: /hpc/local/CentOS7/dhl_ec/software/MetaGWASToolKit/RESOURCES
Reference used.................................: 1Gp1
Main directory.................................: /hpc/local/CentOS7/dhl_ec/software/MetaGWASToolKit/EXAMPLE
Main analysis output directory.................: SOMEGWAS
Subproject's analysis output directory.........: SOMEGWAS/MODEL1
Original data directory........................: /hpc/local/CentOS7/dhl_ec/software/MetaGWASToolKit/EXAMPLE/RAWDATA
We are processing these cohort(s)..............:
     * COHORT1
     * COHORT2
     * COHORT3
Raw data directory.............................: SOMEGWAS/MODEL1/RAW
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

[1m#========================================================================================================[00m
[1m#== FOREST PLOTTER OF META-ANALYSIS RESULTS -- NOT IMPLEMENTED YET[00m
[1m#========================================================================================================[00m
[1m#[00m
[2m[01;31mCREATE[00m
[2m[01;31mPerform R-based meta-analysis to plot; likely the results will slightly differ because of Perl <> R[00m
[2m[01;31mPlan:[00m
[2m[01;31m- Extract top hits from clumper[00m
[2m[01;31m- Extract these variants from each input cohort-meta-file ([cohort].reorder.cdat.gz)[00m
[2m[01;31m- Make file out of this (beta, se, p, n, name, variantid, hwe, info)[00m
[2m[01;31m- Input for meta-analysis R script[00m
[2m[01;31m- R: meta-analysis[00m
[2m[01;31m- R: forest plot[00m
[2m[01;31m- R: include heterogeneity[00m
[1m#========================================================================================================[00m
[1m#== ANNOTATING META-ANALYSIS RESULTS [00m
[1m#========================================================================================================[00m
[1m#[00m
Many online tools are available, for your convenience, we will create input files for a/several popular one(s).

* Creating input file for FUMAGWAS -- http://fuma.ctglab.nl/snp2gene
Your job 7363578 ("Annot.FUMA") has been submitted
[1m#========================================================================================================[00m
[1m#== GENE-BASED ANALYSIS OF META-ANALYSIS RESULTS USING VEGAS2[00m
[1m#========================================================================================================[00m
[1m#[00m
Creating VEGAS input files...
mkdir: created directory â€˜/hpc/local/CentOS7/dhl_ec/software/MetaGWASToolKit/EXAMPLE/SOMEGWAS/MODEL1/META/vegasâ€™
mode of â€˜/hpc/local/CentOS7/dhl_ec/software/MetaGWASToolKit/EXAMPLE/SOMEGWAS/MODEL1/META/vegasâ€™ changed from 0755 (rwxr-xr-x) to 0777 (rwxrwxrwx)
...per chromosome.
Processing chromosome 1...
Your job 7363579 ("VEGAS2.EXAMPLEPHENOTYPE.chr1") has been submitted
Processing chromosome 2...
Your job 7363580 ("VEGAS2.EXAMPLEPHENOTYPE.chr2") has been submitted
Processing chromosome 3...
Your job 7363581 ("VEGAS2.EXAMPLEPHENOTYPE.chr3") has been submitted
Processing chromosome 4...
Your job 7363582 ("VEGAS2.EXAMPLEPHENOTYPE.chr4") has been submitted
Processing chromosome 5...
Your job 7363583 ("VEGAS2.EXAMPLEPHENOTYPE.chr5") has been submitted
Processing chromosome 6...
Your job 7363585 ("VEGAS2.EXAMPLEPHENOTYPE.chr6") has been submitted
Processing chromosome 7...
Your job 7363586 ("VEGAS2.EXAMPLEPHENOTYPE.chr7") has been submitted
Processing chromosome 8...
Your job 7363587 ("VEGAS2.EXAMPLEPHENOTYPE.chr8") has been submitted
Processing chromosome 9...
Your job 7363588 ("VEGAS2.EXAMPLEPHENOTYPE.chr9") has been submitted
Processing chromosome 10...
Your job 7363589 ("VEGAS2.EXAMPLEPHENOTYPE.chr10") has been submitted
Processing chromosome 11...
Your job 7363590 ("VEGAS2.EXAMPLEPHENOTYPE.chr11") has been submitted
Processing chromosome 12...
Your job 7363591 ("VEGAS2.EXAMPLEPHENOTYPE.chr12") has been submitted
Processing chromosome 13...
Your job 7363592 ("VEGAS2.EXAMPLEPHENOTYPE.chr13") has been submitted
Processing chromosome 14...
Your job 7363593 ("VEGAS2.EXAMPLEPHENOTYPE.chr14") has been submitted
Processing chromosome 15...
Your job 7363594 ("VEGAS2.EXAMPLEPHENOTYPE.chr15") has been submitted
Processing chromosome 16...
Your job 7363595 ("VEGAS2.EXAMPLEPHENOTYPE.chr16") has been submitted
Processing chromosome 17...
Your job 7363596 ("VEGAS2.EXAMPLEPHENOTYPE.chr17") has been submitted
Processing chromosome 18...
Your job 7363597 ("VEGAS2.EXAMPLEPHENOTYPE.chr18") has been submitted
Processing chromosome 19...
Your job 7363598 ("VEGAS2.EXAMPLEPHENOTYPE.chr19") has been submitted
Processing chromosome 20...
Your job 7363599 ("VEGAS2.EXAMPLEPHENOTYPE.chr20") has been submitted
Processing chromosome 21...
Your job 7363600 ("VEGAS2.EXAMPLEPHENOTYPE.chr21") has been submitted
Processing chromosome 22...
Your job 7363601 ("VEGAS2.EXAMPLEPHENOTYPE.chr22") has been submitted
Processing chromosome X...
Your job 7363602 ("VEGAS2.EXAMPLEPHENOTYPE.chr23") has been submitted
[1m#========================================================================================================[00m
[1m#== GENE-BASED ANALYSIS OF META-ANALYSIS RESULTS USING MAGMA[00m
[1m#========================================================================================================[00m
[1m#[00m
Creating MAGMA input files...
mkdir: created directory â€˜/hpc/local/CentOS7/dhl_ec/software/MetaGWASToolKit/EXAMPLE/SOMEGWAS/MODEL1/META/magmaâ€™
mode of â€˜/hpc/local/CentOS7/dhl_ec/software/MetaGWASToolKit/EXAMPLE/SOMEGWAS/MODEL1/META/magmaâ€™ changed from 0755 (rwxr-xr-x) to 0777 (rwxrwxrwx)
 - whole-genome...
Your job 7363603 ("MAGMA.ANALYSIS.EXAMPLEPHENOTYPE") has been submitted
Your job 7363604 ("MAGMA.ANNOTATION.EXAMPLEPHENOTYPE") has been submitted
Your job 7363605 ("MAGMA.GSEA.EXAMPLEPHENOTYPE") has been submitted
[1m#========================================================================================================[00m
[1m#== LD SCORE REGRESSION -- the *input* files for LD-Hub are created --[00m
[1m#========================================================================================================[00m
[1m#[00m
We will make use of LD-Hub (http://ldsc.broadinstitute.org) to calculate genetic correlation with other traits.

Generating LD-Hub input file.
mkdir: created directory â€˜/hpc/local/CentOS7/dhl_ec/software/MetaGWASToolKit/EXAMPLE/SOMEGWAS/MODEL1/META/ldscoreâ€™
Your job 7363606 ("LDSCORE.EXAMPLEPHENOTYPE") has been submitted
[1m#========================================================================================================[00m
[1m#== MR BASE -- the *input* files for MR-Base are created --[00m
[1m#========================================================================================================[00m
[1m#[00m
We will make use of MR-Base (http://www.mrbase.org/) to infer causality to other traits.

Generating MR-Base input file, based on p-value <= 5e-8.
mkdir: created directory â€˜/hpc/local/CentOS7/dhl_ec/software/MetaGWASToolKit/EXAMPLE/SOMEGWAS/MODEL1/META/mrbaseâ€™
Your job 7363607 ("MRBASE.EXAMPLEPHENOTYPE") has been submitted
[1m#========================================================================================================[00m
[1m#== DEPICT -- needs implementation --[00m
[1m#========================================================================================================[00m
[1m#[00m
[2m[01;31m- download DEPICT[00m
[2m[01;31m- do clumping for additional DEPICT analysis; their advise is p<5e-5.[00m
[2m[01;31m- add in DEPICT options in configuration file[00m
[1m#========================================================================================================[00m
[1m#== LOCUSTRACK -- the *input* files for LocusTrack are created --[00m
[1m#========================================================================================================[00m
[1m#[00m
LocusTrack is a web-based application that creates visual representations of regional GWAS results and 
integrates user-specified annotation tracks, along with other features such as linkage disequilibrium (LD) 
and genes within the region of interest. LocusTrack can also create Manhattan- and QQ-plots, as well as 
MIAMI-plots for comparison of two GWAS results.

We will create input files for LocusTrack -- https://gump.qimr.edu.au/general/gabrieC/LocusTrack/index.html.

Your job 7363608 ("Annot.LocusTrack") has been submitted

+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
+ The MIT License (MIT)                                                                                 +
+ Copyright (c) 2015-2018 Sander W. van der Laan                                                        +
+                                                                                                       +
+ Permission is hereby granted, free of charge, to any person obtaining a copy of this software and     +
+ associated documentation files (the "Software"), to deal in the Software without restriction,         +
+ including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, +
+ and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, +
+ subject to the following conditions:                                                                  +
+                                                                                                       +
+ The above copyright notice and this permission notice shall be included in all copies or substantial  +
+ portions of the Software.                                                                             +
+                                                                                                       +
+ THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT     +
+ NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND                +
+ NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES  +
+ OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN   +
+ CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.                            +
+                                                                                                       +
+ Reference: http://opensource.org.                                                                     +
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
